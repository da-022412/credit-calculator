<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="main.css" />
    </head>
    <body>
        <section class="calculator">
            <div class="calculator-wrap">
                <form
                    oninput="x.value=(parseInt(eligible.value)*0.025)+((parseInt(total.value)-parseInt(eligible.value))*0.015);y.value=parseInt(x.value)*2;"
                >
                    <div class="calculator-flex">
                        <div class="calculator-sliders">
                            <div class="calculator-slider">
                                <h5>Total monthly spend</h5>
                                <div class="range-wrap">
                                    <input
                                        type="range"
                                        id="total"
                                        name="total"
                                        min="0"
                                        max="20000"
                                        step="100"
                                        class="range"
                                    />
                                    <output class="bubble"></output>
                                </div>
                            </div>
                            <div class="calculator-slider">
                                <h5>
                                    Total monthly spend on eligible Health &amp;
                                    Wellness
                                </h5>
                                <div class="range-wrap">
                                    <input
                                        type="range"
                                        id="eligible"
                                        name="eligible"
                                        min="0"
                                        max="20000"
                                        step="100"
                                        class="range"
                                    />
                                    <output class="bubble"></output>
                                </div>
                            </div>
                        </div>
                        <div class="calculator-results">
                            <div class="calculator-results-wrap">
                                <div class="total-base">
                                    <h4>Base cash back:</h4>
                                    $<output name="x" for="total eligible">
                                        0
                                    </output>
                                </div>
                                <div class="total-boost">
                                    <h4>With Boost cash back:</h4>
                                    $<output name="y" for="total eligible">
                                        0
                                    </output>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </section>
        <div class="sub-title">
            <h5>
                When you hit your 150-minute Paceline Streak, you'll unlock a
                cash back Boost.
            </h5>
        </div>
        <script>
            const allRanges = document.querySelectorAll('.range-wrap');
            allRanges.forEach((wrap) => {
                const range = wrap.querySelector('.range');
                const bubble = wrap.querySelector('.bubble');

                range.addEventListener('input', () => {
                    setBubble(range, bubble);
                });
                setBubble(range, bubble);
            });

            function setBubble(range, bubble) {
                const val = range.value;
                const min = range.min ? range.min : 0;
                const max = range.max ? range.max : 100;
                const newVal = Number(((val - min) * 100) / (max - min));
                bubble.innerHTML = val;

                // Sorta magic numbers based on size of the native UI thumb
                bubble.style.left = `calc(${newVal}% + (${
                    8 - newVal * 0.15
                }px))`;
            }
        </script>
    </body>
</html>
